<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/SRC/CSS/home_admin.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <title>Administraci√≥n</title>
<script>
  // Bloquea acceso si no hay token
  if (!localStorage.getItem("token")) {
    window.location.replace("/");
  }

  // ‚úÖ Guardar el ID de sesi√≥n actual de ESTA pesta√±a
  const mySessionId = localStorage.getItem("session_id");
  console.log("üîë Mi session_id:", mySessionId);

  // ‚úÖ Escuchar cambios en localStorage (otra pesta√±a cambia el session_id)
  window.addEventListener('storage', function(e) {
    // Si otra pesta√±a inici√≥ sesi√≥n con OTRO usuario
    if (e.key === 'session_id' && e.newValue !== mySessionId && e.newValue !== null) {
      console.warn("‚ö†Ô∏è Nueva sesi√≥n detectada en otra pesta√±a. Cerrando esta sesi√≥n...");
      alert("‚ö†Ô∏è Se detect√≥ un inicio de sesi√≥n en otra pesta√±a. Esta sesi√≥n se cerrar√°.");
      
      // NO limpiar el localStorage aqu√≠ (la otra pesta√±a ya tiene los datos correctos)
      window.location.replace("/");
    }
    
    // Si se elimin√≥ el token (logout desde otra pesta√±a)
    if (e.key === 'token' && e.newValue === null) {
      console.warn("‚ö†Ô∏è Sesi√≥n cerrada desde otra pesta√±a");
      alert("‚ö†Ô∏è La sesi√≥n se cerr√≥ desde otra pesta√±a.");
      window.location.replace("/");
    }
  });

  // Tambi√©n detecta navegaci√≥n hacia adelante/atr√°s
  window.addEventListener('pageshow', function(event) {
    if (event.persisted || !localStorage.getItem("token")) {
      window.location.replace("/");
    }
  });
</script>

</head>
<body>
    <div class="principal">
        <header>
            <button id="btnLogout" style="
  position: fixed;
  top: 15px;
  right: 20px;
  padding: 10px 15px;
  border: none;
  background: linear-gradient(45deg, #e74c3c, #c0392b);
  color: white;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
">
  üö™ Cerrar sesi√≥n
</button>

            <h4>Panel de administraci√≥n</h4>
        </header>
        
        <div id="sidebar">
            <div class="toggle-btn">
                <span>‚ò∞</span>
            </div>
            <ul class="lista_sidebar">
                <!-- ‚úÖ AGREGAR data-module -->
                <li class="btn-module" data-module="albums">√Ålbums</li>
                <li class="btn-module" data-module="usuarios">Usuarios</li>
                <!-- <li class="btn-module" data-module="canciones">Canciones</li>
                <li class="btn-module" data-module="playlist">Playlist</li> -->
            </ul>
        </div>
        
        <div class="contenedor" id="contenedor-principal">
            <h2>Bienvenido al panel de administraci√≥n</h2>
            <p>Selecciona una opci√≥n del men√∫</p>
        </div>
    </div>
        
        <footer>
            <p>&copy; 2025 PTV-Online</p>
        </footer>
    </div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Select2 -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<!-- Tu script principal -->
<script src="/SRC/JS/main_admin_dashboard.js"></script>

</body>
</html>