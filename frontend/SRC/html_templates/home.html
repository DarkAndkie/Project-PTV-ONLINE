<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéµ Dashboard de M√∫sica</title>
    <link rel="stylesheet" href="/SRC/CSS/main_dashboard.css">
    <script>
  if (!localStorage.getItem("token")) {
    window.location.replace("/");
  }
  window.onpageshow = function(event) {
    if (event.persisted || !localStorage.getItem("token")) {
      window.location.replace("/");
    }
  };
</script>

</head>
<body>
    <div class="dashboard-container">
        <!-- HEADER / NAVBAR -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">‚ô™</div>
                    <h1 class="logo-text">PTV Music</h1>
                </div>
                
                <nav class="nav-menu">
                    <button class="nav-btn active" data-section="discover">üéµ Descubrir</button>
                    <button class="nav-btn" data-section="search">üîç Buscar</button>
                    <button class="nav-btn" data-section="playlists">üìã Mis Playlists</button>
                    <button class="nav-btn" data-section="admin-cuenta">Administraci√≥n</button>
                </nav>

                <div class="header-actions">
                    <span id="userRole" class="user-role-badge"></span>
                    <button id="btnLogout" class="btn-logout">üö™ Cerrar Sesi√≥n</button>
                </div>
            </div>
        </header>

        <div class="dashboard-content">
            <!-- SIDEBAR IZQUIERDO - REPRODUCTOR -->
            <aside class="sidebar-player">
                <div class="now-playing-card">
                    <div class="now-playing-image">
                        <img id="playerCover" src="/placeholder.svg?height=200&width=200" alt="Cover">
                    </div>
                    <div class="now-playing-info">
                        <p class="track-label">Ahora reproduciendo</p>
                        <h3 id="playerTitle">Selecciona una canci√≥n</h3>
                        <p id="playerArtist" class="player-artist">Artista</p>
                    </div>
                </div>

                <!-- PLAYER CONTROLS -->
                <div class="player-controls">
                    <audio id="audioPlayer" style="display: none;"></audio>
                    
                    <div class="time-display">
                        <span id="currentTime">00:00</span>
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill"></div>
                            <input type="range" id="progressSlider" min="0" max="100" value="0">
                        </div>
                        <span id="duration">00:00</span>
                    </div>

                    <div class="control-buttons">
                        <button id="prevBtn" class="control-btn">‚èÆ</button>
                        <button id="playBtn" class="control-btn play-btn">‚ñ∂</button>
                        <button id="nextBtn" class="control-btn">‚è≠</button>
                    </div>

                    <div class="volume-control">
                        <span>üîä</span>
                        <input type="range" id="volumeSlider" min="0" max="100" value="70">
                        <span id="volumeValue">70%</span>
                    </div>
                </div>

                <!-- QUEUE -->
                <div class="queue-section">
                    <h4>Cola de reproducci√≥n</h4>
                    <div id="queueList" class="queue-list">
                        <p style="text-align: center; color: var(--text-secondary);">Queue vac√≠a</p>
                    </div>
                </div>
            </aside>

            <!-- CONTENIDO PRINCIPAL -->
            <main class="main-content">
                <!-- SECTION: DISCOVER -->
                <section id="section-discover" class="content-section active">
                    <div class="section-header">
                        <h2>üé∏ Descubre M√∫sica</h2>
                        <button id="refreshBtn" class="btn-refresh">üîÑ Refrescar</button>
                    </div>

                    <!-- RANDOM SONGS GRID -->
                    <div class="songs-grid" id="songsGrid">
                        <div class="loading-spinner">Cargando canciones...</div>
                    </div>
                </section>

                <!-- SECTION: SEARCH -->
                <section id="section-search" class="content-section">
                    <div class="section-header">
                        <h2>üîç B√∫squeda Avanzada</h2>
                    </div>

                    <!-- SEARCH BAR -->
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Buscar canciones, √°lbumes..." class="search-input">
                        <div class="search-filters">
                            <button class="filter-btn active" data-filter="all">Todos</button>
                            <button class="filter-btn" data-filter="songs">Canciones</button>
                            <button class="filter-btn" data-filter="albums">√Ålbumes</button>
                        </div>
                    </div>

                    <!-- SEARCH RESULTS -->
                    <div id="searchResults" class="search-results">
                        <p style="text-align: center; color: var(--text-secondary);">Empieza a buscar...</p>
                    </div>
                </section>

                <!-- SECTION: PLAYLISTS -->
                <section id="section-playlists" class="content-section">
                    <div class="section-header">
                        <h2>üìã Mis Playlists</h2>
                        <button id="createPlaylistBtn" class="btn-primary">+ Nueva Playlist</button>
                    </div>

                    <!-- MODAL CREAR PLAYLIST -->
                    <div id="createPlaylistModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Nueva Playlist</h3>
                                <button class="modal-close">&times;</button>
                            </div>
                            <div class="modal-body">
                                <input type="text" id="playlistName" placeholder="Nombre de la playlist" maxlength="50">
                                <textarea id="playlistDescription" placeholder="Descripci√≥n (opcional)" maxlength="200" rows="3"></textarea>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="playlistPublic">
                                    <span>Hacer p√∫blica</span>
                                </label>
                            </div>
                            <div class="modal-footer">
                                <button class="btn-secondary modal-close">Cancelar</button>
                                <button id="savePlaylistBtn" class="btn-primary">Crear</button>
                            </div>
                        </div>
                    </div>

                    <!-- PLAYLISTS LIST -->
                    <div id="playlistsList" class="playlists-grid">
                        <div class="loading-spinner">Cargando playlists...</div>
                    </div>
                </section>
<section id="section-admin-cuenta" class="content-section">
    <div class="section-header">
        <h2>‚öôÔ∏è Administraci√≥n</h2>
        <button id="btnCreateAlbum" class="btn-primary">+ Crear √Ålbum</button>
    </div>

    <!-- Contenido para BANDAS -->
    <div id="banda-content">
        <h3>Mis √Ålbumes</h3>
        <div id="albumsGrid" class="songs-grid">
            <div class="loading-spinner">Cargando √°lbumes...</div>
        </div>
    </div>

    <!-- Contenido para OTROS ROLES -->
    <div id="other-content" style="display: block;">
        <p style="text-align: center; color: var(--text-secondary); padding: 40px;">
           <div style="max-width: 600px; margin: 0 auto; padding: 30px; background: rgba(26, 188, 156, 0.05); border-radius: 12px; border: 1px solid var(--border-color);">
      <h2 style="margin-bottom: 30px; color: var(--primary);">‚öôÔ∏è Mi Cuenta</h2>
      
      <div class="form-group" style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">Nombre</label>
        <input type="text" id="user-nombre" value="" style="width: 100%; padding: 12px; background: var(--bg-darker); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
      </div>
      
      <div class="form-group" style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">Apellido</label>
        <input type="text" id="user-apellido" value="" style="width: 100%; padding: 12px; background: var(--bg-darker); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
      </div>
      
      <div class="form-group" style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">Correo</label>
        <input type="email" id="user-email" value="" style="width: 100%; padding: 12px; background: var(--bg-darker); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
      </div>
      
      <div class="form-group" style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">Tel√©fono</label>
        <input type="tel" id="user-tel" value="" style="width: 100%; padding: 12px; background: var(--bg-darker); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
      </div>
      
      <div class="form-group" style="margin-bottom: 30px;">
        <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">Nueva Contrase√±a (opcional)</label>
        <input type="password" id="user-password" placeholder="Dejar vac√≠o para no cambiar" style="width: 100%; padding: 12px; background: var(--bg-darker); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary);">
        <small style="color: var(--text-secondary); font-size: 12px; display: block; margin-top: 5px;">M√≠nimo 8 caracteres, incluye letras, n√∫meros y s√≠mbolos</small>
      </div>
      
      <button onclick="guardarDatosPersonales()" style="width: 100%; padding: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
        Guardar Cambios
      </button>
    </div>
        </p>
    </div>
</section>
                <!-- SECTION: FAVORITES -->
                <section id="section-favorite" class="content-section">
                    <div class="section-header">
                        <h2>‚ù§Ô∏è Mis Favoritos</h2>
                        <span id="favCount" class="count-badge">0</span>
                    </div>

                    <div id="favoritesList" class="songs-grid">
                        <p style="text-align: center; color: var(--text-secondary);">No tienes canciones favoritas a√∫n</p>
                    </div>
                </section>
            </main>
        </div>

        <!-- MODAL DETALLES DE CANCI√ìN -->
        <div id="songDetailModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Detalles de la canci√≥n</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="song-detail-info">
                        <img id="modalCover" src="/placeholder.svg" alt="Cover">
                        <div class="detail-text">
                            <h4 id="modalTitle"></h4>
                            <p id="modalArtist"></p>
                            <p id="modalDuration"></p>
                            <p id="modalAlbum"></p>
                            <div id="modalDisableSection" class="modal-disable-section" style="display: none;">
                                <p id="disableInfo" style="color: var(--primary); font-size: 0.85rem;"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="addToPlaylistBtn" class="btn-primary">Agregar a Playlist</button>
                    <button id="toggleFavBtn" class="btn-secondary">Agregar a Favoritos</button>
                    <button id="toggleDisableBtn" class="btn-secondary" style="display: none; background: #e74c3c; border-color: #e74c3c; color: white;"></button>
                </div>
            </div>
        </div>

        <!-- MODAL AGREGAR A PLAYLIST -->
        <div id="addToPlaylistModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Agregar a Playlist</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="playlistsForAdd" class="playlists-list-modal">
                        <p style="text-align: center;">Cargando playlists...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODAL √ÅLBUMES CON CANCIONES -->
        <div id="albumDetailModal" class="modal" style="display: none;">
            <div class="modal-content large-modal">
                <div class="modal-header">
                    <h3 id="albumModalTitle">Detalles del √Ålbum</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="album-detail-header">
                        <img id="albumModalCover" src="/placeholder.svg" alt="Album Cover" class="album-detail-cover">
                        <div class="album-detail-info">
                            <h2 id="albumDetailName"></h2>
                            <p id="albumDetailDescription"></p>
                            <p id="albumDetailSongCount" style="color: var(--primary); margin-top: 1rem; font-weight: 600;"></p>
                        </div>
                    </div>
                    <div class="album-songs-section">
                        <h4 style="margin-bottom: 1rem;">Canciones del √°lbum</h4>
                        <div id="albumSongsList" class="album-songs-list">
                            <p style="text-align: center; color: var(--text-secondary);">Cargando canciones...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/SRC/JS/main_dashboard.js"></script>
</body>
</html>
